import{q as N,w as P,J as T,b as c,j as i,B as f,K as R,r as I,F as j,k as U}from"./index-adccf17c.js";import{u as M}from"./index.esm-f0940a56.js";import{F as E}from"./Form-2653b5a8.js";import{F as l,I as v}from"./FormRow-cfe24e74.js";import{F as B}from"./FileInput-8669a2db.js";import{R as A}from"./Row-ec799910.js";var K=e=>typeof e=="function",q=(e,t)=>K(e)?e(t):e,L=(()=>{let e=0;return()=>(++e).toString()})(),Q=20,h=new Map,H=1e3,x=e=>{if(h.has(e))return;let t=setTimeout(()=>{h.delete(e),g({type:4,toastId:e})},H);h.set(e,t)},J=e=>{let t=h.get(e);t&&clearTimeout(t)},F=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,Q)};case 1:return t.toast.id&&J(t.toast.id),{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:a}=t;return e.toasts.find(s=>s.id===a.id)?F(e,{type:1,toast:a}):F(e,{type:0,toast:a});case 3:let{toastId:r}=t;return r?x(r):e.toasts.forEach(s=>{x(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===r||r===void 0?{...s,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let o=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+o}))}}},V=[],C={toasts:[],pausedAt:void 0},g=e=>{C=F(C,e),V.forEach(t=>{t(C)})},_=(e,t="blank",a)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...a,id:(a==null?void 0:a.id)||L()}),p=e=>(t,a)=>{let r=_(t,e,a);return g({type:2,toast:r}),r.id},n=(e,t)=>p("blank")(e,t);n.error=p("error");n.success=p("success");n.loading=p("loading");n.custom=p("custom");n.dismiss=e=>{g({type:3,toastId:e})};n.remove=e=>g({type:4,toastId:e});n.promise=(e,t,a)=>{let r=n.loading(t.loading,{...a,...a==null?void 0:a.loading});return e.then(o=>(n.success(q(t.success,o),{id:r,...a,...a==null?void 0:a.success}),o)).catch(o=>{n.error(q(t.error,o),{id:r,...a,...a==null?void 0:a.error})}),e};var D=n;function k(){const e=N(),{mutate:t,isLoading:a}=P({mutationFn:T,onSuccess:()=>{D.success("User Account successfully updated"),e.invalidateQueries({queryKey:["user"]})},onError:r=>D.error(r.message)});return{updateUser:t,isUpdating:a}}function z(){var d,S;const{register:e,handleSubmit:t,formState:a,getValues:r,reset:o}=M(),{errors:s}=a,{updateUser:w,isUpdating:u}=k();function b({password:m}){w({password:m},{onSuccess:()=>o()})}function y(m){o()}return c(E,{onSubmit:t(b),children:[i(l,{label:"Password (min 8 characters)",error:(d=s==null?void 0:s.password)==null?void 0:d.message,children:i(v,{type:"password",id:"password",autoComplete:"current-password",disabled:u,...e("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),i(l,{label:"Confirm password",error:(S=s==null?void 0:s.passwordConfirm)==null?void 0:S.message,children:i(v,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:u,...e("passwordConfirm",{required:"This field is required",validate:m=>r().password===m||"Passwords need to match"})})}),c(l,{children:[i(f,{onClick:y,type:"reset",variation:"secondary",children:"Cancel"}),i(f,{disabled:u,children:"Update password"})]})]})}function G(){const{user:{email:e,user_metadata:{fullName:t}}}=R(),{updateUser:a,isUpdating:r}=k(),[o,s]=I.useState(t),[w,u]=I.useState(null);function b(d){d.preventDefault(),o&&a({fullName:o,avatar:w},{onSuccess:()=>{u(null),d.target.reset()}})}function y(){s(t),u(null)}return c(E,{onSubmit:b,children:[i(l,{label:"Email address",children:i(v,{value:e,disabled:!0})}),i(l,{label:"Full name",children:i(v,{disabled:r,type:"text",value:o,onChange:d=>s(d.target.value),id:"fullName"})}),i(l,{label:"Avatar image",children:i(B,{disabled:r,id:"avatar",accept:"image/*",onChange:d=>u(d.target.files[0])})}),c(l,{children:[i(f,{disabled:r,type:"reset",variation:"secondary",onClick:y,children:"Cancel"}),i(f,{disabled:r,children:"Update account"})]})]})}function ee(){return c(j,{children:[i(U,{as:"h1",children:"Update your account"}),c(A,{children:[i(U,{as:"h3",children:"Update user data"}),i(G,{})]}),c(A,{children:[i(U,{as:"h3",children:"Update password"}),i(z,{})]})]})}export{ee as default};
